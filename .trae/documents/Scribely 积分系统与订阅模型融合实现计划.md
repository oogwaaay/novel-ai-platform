# Scribely ç§¯åˆ†ç³»ç»Ÿä¸è®¢é˜…æ¨¡å‹èåˆå®ç°è®¡åˆ’

## ä¸€ã€æ ¸å¿ƒæ¶æ„è®¾è®¡

### 1. ç§¯åˆ†ç³»ç»Ÿä¸è®¢é˜…æ¨¡å‹å…³ç³»
- **è®¢é˜…è®¡åˆ’**ï¼šå†³å®šæ¯æœˆç§¯åˆ†æ´¥è´´å’ŒåŠŸèƒ½æƒé™
- **ç§¯åˆ†**ï¼šç”¨äºæ”¯ä»˜é«˜æˆæœ¬AIåŠŸèƒ½ï¼ˆå¦‚å›¾åƒç”Ÿæˆã€æ¨¡å‹è®­ç»ƒï¼‰
- **æ ¸å¿ƒåŸåˆ™**ï¼šæ–‡æœ¬ç”Ÿæˆå¯¹Pro/Unlimitedç”¨æˆ·å…è´¹ï¼Œå…¶ä»–ç”¨æˆ·æ‰£ç§¯åˆ†ï¼›æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨é«˜æˆæœ¬åŠŸèƒ½éƒ½æ‰£ç§¯åˆ†

### 2. æ•°æ®åº“æ‰©å±•
- **ä¿®æ”¹è¡¨**ï¼š`point_transactions` æ–°å¢ `source` å­—æ®µï¼ˆBONUS/PAIDï¼‰
- **æ–°å¢è¡¨**ï¼š`point_grants` è®°å½•æ¯æœˆç§¯åˆ†å‘æ”¾
- **æ–°å¢è¡¨**ï¼š`subscription_tiers` ç®¡ç†ä¸åŒè®¢é˜…ç­‰çº§çš„ç§¯åˆ†è§„åˆ™

## äºŒã€è®¢é˜…è®¡åˆ’è¯¦ç»†æ”¹é€ 

### 1. Free Plan (å…è´¹ç‰ˆ)
- **æœˆåº¦ç§¯åˆ†æ´¥è´´**ï¼š500 ç§¯åˆ† / æœˆ
- **AI æ¨¡å‹é™åˆ¶**ï¼šä»…é™ DeepSeek æ¨¡å‹
- **åŠŸèƒ½é™åˆ¶**ï¼šæ— æ³•ä½¿ç”¨"é£æ ¼ä»¿å†™"ç­‰é«˜çº§åŠŸèƒ½
- **å®šä½**ï¼šç”¨æˆ·ä½“éªŒè¯±é¥µï¼Œè¶³å¤Ÿç”Ÿæˆ 1 ä¸ªè§’è‰²å¤´åƒ + 2 ç« å¤§çº² + 1000 å­—è¯•å†™

### 2. Starter Plan (å…¥é—¨ç‰ˆ) - $12/mo
- **æœˆåº¦ç§¯åˆ†æ´¥è´´**ï¼š5,000 ç§¯åˆ† / æœˆ
- **AI æ¨¡å‹**ï¼šæ”¯æŒ DeepSeek æ¨¡å‹ï¼ŒæŒ‰æ ‡å‡†è´¹ç‡æ‰£ç§¯åˆ†
- **å®šä½**ï¼šæŒ‰é‡ä»˜è´¹çš„è½»åº¦ç”¨æˆ·ï¼Œè¶³å¤Ÿå†™å®Œä¸€æœ¬ä¸­ç¯‡å°è¯´æˆ–ç”Ÿæˆå‡ åå¼ å›¾

### 3. Pro Plan (ä¸“ä¸šç‰ˆ) - $25/mo ã€å…³é”®æ”¹é€ ç‚¹ã€‘
- **æ ¸å¿ƒæƒç›Š**ï¼š
  - âœï¸ æ–‡æœ¬å†™ä½œï¼šæ— é™ä¸æ‰£åˆ†ï¼ˆä¿æŒåŸæœ‰æ‰¿è¯ºï¼‰
  - ğŸ’ å¢å€¼ç§¯åˆ†ï¼šæ¯æœˆèµ é€ 2,000 ç§¯åˆ†ï¼ˆç”¨äºå›¾åƒç”Ÿæˆç­‰ï¼‰
- **è¯æœ¯è°ƒæ•´**ï¼šå°†"Unlimited Credits"æ”¹ä¸º"Unlimited Writing + 2,000 AI Art Points"
- **å®šä½**ï¼šæ»¡è¶³ä½œè€…"æƒ³å†™å¤šå°‘å†™å¤šå°‘"çš„å®‰å…¨æ„Ÿï¼ŒåŒæ—¶é™åˆ¶é«˜æˆæœ¬èµ„æºæ»¥ç”¨

### 4. Unlimited Plan (æ——èˆ°ç‰ˆ) - $39.9/mo
- **æ ¸å¿ƒæƒç›Š**ï¼š
  - âœï¸ æ–‡æœ¬å†™ä½œï¼šæ— é™ + æé€Ÿé€šé“
  - ğŸ’ å¢å€¼ç§¯åˆ†ï¼šæ¯æœˆèµ é€ 10,000 ç§¯åˆ†ï¼ˆPro ç‰ˆçš„ 5 å€ï¼‰
  - ğŸ‘‘ ç‹¬å®¶ç‰¹æƒï¼šç§¯åˆ†å¯æ»šå­˜ï¼ˆRolloverï¼‰
- **å®šä½**ï¼šå¯éšå¿ƒæ‰€æ¬²ç”Ÿæˆè§’è‰²ç«‹ç»˜å’Œå°é¢å›¾çš„é«˜çº§ç”¨æˆ·

## ä¸‰ã€UI/UX äº¤äº’è®¾è®¡

### 1. é¡¶éƒ¨å¯¼èˆªæ ç§¯åˆ†æ˜¾ç¤º
- **å®ç°å†…å®¹**ï¼šåœ¨é¡¶éƒ¨å¯¼èˆªæ æ·»åŠ ç§¯åˆ†ä½™é¢æ˜¾ç¤ºï¼ˆä¾‹å¦‚ï¼šğŸ’§ 120ï¼‰
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/components/Header.tsx`
- **æŠ€æœ¯è¦ç‚¹**ï¼šä½¿ç”¨ `usePoints` é’©å­è·å–ä½™é¢ï¼Œæ·»åŠ å“åº”å¼è®¾è®¡

### 2. ç”ŸæˆæŒ‰é’®æˆæœ¬æç¤º
- **å®ç°å†…å®¹**ï¼šåœ¨ç”ŸæˆæŒ‰é’®æ—æ·»åŠ ç°è‰²å°å­—æ ‡æ³¨æˆæœ¬ï¼ˆä¾‹å¦‚ï¼š"Generate Chapter (-30 ğŸ’§)"ï¼‰
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/components/StoryEditor.tsx`ã€`src/pages/Generator.tsx`
- **æŠ€æœ¯è¦ç‚¹**ï¼šæ ¹æ®ä¸åŒåŠŸèƒ½åŠ¨æ€æ˜¾ç¤ºæˆæœ¬ï¼ŒPro/Unlimited ç”¨æˆ·æ–‡æœ¬ç”Ÿæˆä¸æ˜¾ç¤ºæˆæœ¬

### 3. ç§¯åˆ†ä¸è¶³ä»»åŠ¡ä¸­å¿ƒæ¨¡æ€æ¡†
- **å®ç°å†…å®¹**ï¼šå½“ç§¯åˆ†ä¸è¶³æ—¶ï¼Œå¼¹å‡ºä»»åŠ¡ä¸­å¿ƒæ¨¡æ€æ¡†ï¼Œæä¾›è·å–ç§¯åˆ†çš„é€‰é¡¹
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/components/PointsExhaustedModal.tsx`ï¼ˆæ‰©å±•ç°æœ‰ç»„ä»¶ï¼‰
- **æŠ€æœ¯è¦ç‚¹**ï¼šæ·»åŠ ä»»åŠ¡åˆ—è¡¨ï¼ŒåŒ…æ‹¬ç­¾åˆ°ã€åˆ†äº«ã€é‚€è¯·å¥½å‹ç­‰é€‰é¡¹

### 4. ä»ªè¡¨ç›˜åŒä½™é¢æ˜¾ç¤º
- **å®ç°å†…å®¹**ï¼šåœ¨ç”¨æˆ· Dashboard æ˜¾ç¤ºä¸¤ä¸ªä½™é¢ï¼š
  - Subscription: Pro (Unlimited Text)
  - Points Balance: 2,450 ğŸ’
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/pages/Dashboard.tsx`
- **æŠ€æœ¯è¦ç‚¹**ï¼šä½¿ç”¨ `useAuthStore` è·å–è®¢é˜…ä¿¡æ¯ï¼Œ`usePoints` è·å–ç§¯åˆ†ä½™é¢

## å››ã€åç«¯é€»è¾‘æ”¹é€ 

### 1. API è°ƒç”¨ç§¯åˆ†æ‰£é™¤é€»è¾‘
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`backend/src/routes/story.routes.ts`ã€`backend/src/routes/image.routes.ts`
- **æ ¸å¿ƒé€»è¾‘**ï¼šæ ¹æ®ç”¨æˆ·è®¢é˜…ç­‰çº§åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰£ç§¯åˆ†ï¼ŒFree/Starterç”¨æˆ·æŒ‰ç”Ÿæˆå†…å®¹æ‰£è´¹ï¼ŒPro/Unlimitedç”¨æˆ·æ–‡æœ¬ç”Ÿæˆå…è´¹ï¼Œæ‰€æœ‰ç”¨æˆ·ä½¿ç”¨é«˜æˆæœ¬åŠŸèƒ½æ‰£è´¹
  ```typescript
  // æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰£ç§¯åˆ†
  const needsPoints = user.subscription.tier !== 'pro' && user.subscription.tier !== 'unlimited';
  
  if (needsPoints) {
    // è®¡ç®—æ‰€éœ€ç§¯åˆ†
    const pointsNeeded = calculatePointsForGeneration(length, model);
    
    // è°ƒç”¨æ‰£é™¤ç§¯åˆ†å‡½æ•°
    const { data: newBalance, error } = await supabaseAdmin
      .rpc('deduct_user_points', {
        p_user_id: user.id,
        p_amount: pointsNeeded,
        p_type: 'TEXT_GENERATION',
        p_description: `Generate text (${length} words)`
      });
    
    if (error) {
      return res.status(400).json({ message: 'Insufficient points' });
    }
  }
  ```

### 2. æœˆåº¦ç§¯åˆ†æ´¥è´´å‘æ”¾
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`backend/src/services/subscriptionService.ts`
- **å®ç°é€»è¾‘**ï¼šä½¿ç”¨å®šæ—¶ä»»åŠ¡æ¯æœˆ1æ—¥å‘æ´»è·ƒç”¨æˆ·å‘æ”¾å¯¹åº”ç­‰çº§çš„ç§¯åˆ†æ´¥è´´ï¼Œå¹¶è®°å½•å‘æ”¾å†å²
  ```typescript
  // æ¯æœˆ 1 æ—¥å‡Œæ™¨å‘æ”¾ç§¯åˆ†æ´¥è´´
  cron.schedule('0 2 1 * *', async () => {
    // è·å–æ‰€æœ‰æ´»è·ƒç”¨æˆ·
    const { data: activeUsers } = await supabaseAdmin
      .from('users')
      .select('id, subscription');
    
    // ä¸ºæ¯ä¸ªç”¨æˆ·å‘æ”¾ç§¯åˆ†
    for (const user of activeUsers) {
      const pointsToGrant = SUBSCRIPTION_PLANS[user.subscription.tier].monthlyPoints;
      
      // å‘æ”¾ç§¯åˆ†
      await supabaseAdmin
        .rpc('add_user_points', {
          p_user_id: user.id,
          p_amount: pointsToGrant,
          p_type: 'MONTHLY_SUBSCRIPTION_GRANT',
          p_source: 'BONUS',
          p_description: `Monthly subscription points`
        });
      
      // è®°å½•å‘æ”¾å†å²
      await supabaseAdmin
        .from('point_grants')
        .insert({
          user_id: user.id,
          month: currentMonth,
          points_granted: pointsToGrant,
          subscription_tier: user.subscription.tier
        });
    }
  });
  ```

### 3. ç§¯åˆ†æ»šå­˜æœºåˆ¶
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`backend/src/services/pointsService.ts`
- **å®ç°é€»è¾‘**ï¼šä»…Unlimitedç”¨æˆ·æ”¯æŒç§¯åˆ†æ»šå­˜ï¼Œå…¶ä»–ç”¨æˆ·ç§¯åˆ†æœˆåº•æ¸…é›¶
  ```typescript
  // ä»… Unlimited ç”¨æˆ·æ”¯æŒç§¯åˆ†æ»šå­˜
  if (user.subscription.tier === 'unlimited') {
    await supabaseAdmin
      .rpc('extend_points_expiry', {
        p_user_id: user.id,
        p_extend_days: 365
      });
  } else {
    // å…¶ä»–ç”¨æˆ·ç§¯åˆ†æœˆåº•æ¸…é›¶
    await supabaseAdmin
      .rpc('clear_expired_points', {
        p_user_id: user.id
      });
  }
  ```

## äº”ã€ç§¯åˆ†æ¶ˆè€—è§„åˆ™

### 1. æ–‡æœ¬ç”Ÿæˆ
- **Free/Starter**ï¼šæŒ‰å­—æ•°æ‰£è´¹ï¼ˆ0.04 ç§¯åˆ†/å­—ï¼‰
- **Pro/Unlimited**ï¼šå…è´¹

### 2. å›¾åƒç”Ÿæˆ
- **æ‰€æœ‰ç”¨æˆ·**ï¼šæŒ‰è´¨é‡æ‰£è´¹
  - è§’è‰²å¤´åƒï¼š40-50 ç§¯åˆ†/å¼ 
  - é«˜æ¸…å°é¢ï¼š100-150 ç§¯åˆ†/å¼ 
  - åœºæ™¯æ’å›¾ï¼š60 ç§¯åˆ†/å¼ 

### 3. é«˜çº§åŠŸèƒ½
- **æ¨¡å‹è®­ç»ƒ**ï¼š500 ç§¯åˆ†/æ¬¡
- **é£æ ¼ä»¿å†™**ï¼š200-500 ç§¯åˆ†
- **æ„Ÿå®˜æå†™å¢å¼º**ï¼š5-10 ç§¯åˆ†/æ®µ

## å…­ã€UI æ–‡æ¡ˆä¿®æ”¹

### 1. ä»·æ ¼é¡µé¢
- **ä¿®æ”¹å†…å®¹**ï¼šå°† Pro/Unlimited å¥—é¤ä¸­çš„ "Unlimited Credits" æ”¹ä¸º "Unlimited Writing + XXXX AI Art Points"
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/pages/Pricing.tsx`

### 2. åŠŸèƒ½æè¿°
- **ä¿®æ”¹å†…å®¹**ï¼šæ¸…æ™°åŒºåˆ†å…è´¹åŠŸèƒ½å’Œéœ€ç§¯åˆ†åŠŸèƒ½
- **ä¿®æ”¹æ–‡ä»¶**ï¼š`src/components/FeatureCard.tsx`

## ä¸ƒã€å®ç°ä¼˜å…ˆçº§

### P0ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
1. é¡¶éƒ¨å¯¼èˆªæ ç§¯åˆ†æ˜¾ç¤º
2. ä»ªè¡¨ç›˜åŒä½™é¢æ˜¾ç¤º
3. API è°ƒç”¨ç§¯åˆ†æ‰£é™¤é€»è¾‘ï¼ˆæ–‡æœ¬ vs å›¾åƒï¼‰
4. æœˆåº¦ç§¯åˆ†æ´¥è´´å‘æ”¾
5. ä»·æ ¼é¡µé¢æ–‡æ¡ˆä¿®æ”¹

### P1
1. ç”ŸæˆæŒ‰é’®æˆæœ¬æç¤º
2. ç§¯åˆ†ä¸è¶³ä»»åŠ¡ä¸­å¿ƒæ¨¡æ€æ¡†
3. ç§¯åˆ†æ»šå­˜æœºåˆ¶
4. è§’è‰²å¤´åƒç”ŸæˆåŠŸèƒ½

### P2
1. æˆåŠŸåé¦ˆå¾®äº¤äº’
2. ä¸–ç•Œè§‚ç®¡ç†ç³»ç»Ÿ
3. é«˜çº§ AI æ§åˆ¶

### P3
1. å†™ä½œåˆ†æä¸æ¸¸æˆåŒ–
2. é«˜çº§å¯¼å‡ºåŠŸèƒ½

## å…«ã€æŠ€æœ¯ä¾èµ–

- **å‰ç«¯**ï¼šReact, Tailwind CSS, Chart.jsï¼ˆçƒ­åŠ›å›¾ï¼‰
- **åç«¯**ï¼šExpress, Supabase, DeepSeek API
- **æ–°å¢ä¾èµ–**ï¼š
  - `node-cron`ï¼šç”¨äºå®šæ—¶ä»»åŠ¡
  - `chart.js`ï¼šç”¨äºç»˜åˆ¶çƒ­åŠ›å›¾
  - `epub-gen`ï¼šç”¨äº ePub å¯¼å‡º

## ä¹ã€æµ‹è¯•è®¡åˆ’

### 1. åŠŸèƒ½æµ‹è¯•
- ä¸åŒè®¢é˜…ç­‰çº§çš„ç§¯åˆ†æ´¥è´´å‘æ”¾
- æ–‡æœ¬ç”Ÿæˆç§¯åˆ†æ‰£é™¤ï¼ˆFree/Starter æ‰£ï¼ŒPro/Unlimited å…è´¹ï¼‰
- å›¾åƒç”Ÿæˆç§¯åˆ†æ‰£é™¤ï¼ˆæ‰€æœ‰ç”¨æˆ·æ‰£ï¼‰
- ç§¯åˆ†ä¸è¶³æ—¶çš„ä»»åŠ¡ä¸­å¿ƒæ¨¡æ€æ¡†

### 2. è¾¹ç•Œæµ‹è¯•
- ç§¯åˆ†åˆšå¥½å¤Ÿ vs ç§¯åˆ†ä¸è¶³
- æœˆåº¦ç§¯åˆ†å‘æ”¾çš„è¾¹ç•Œæ¡ä»¶
- ç§¯åˆ†æ»šå­˜æœºåˆ¶ï¼ˆUnlimited ç”¨æˆ· vs å…¶ä»–ç”¨æˆ·ï¼‰

### 3. å›å½’æµ‹è¯•
- ç¡®ä¿ç°æœ‰åŠŸèƒ½ä¸å—å½±å“
- ç¡®ä¿ç°æœ‰ç”¨æˆ·æƒç›Šå¾—åˆ°ä¿æŠ¤

## åã€é¢„æœŸæ•ˆæœ

1. **ç”¨æˆ·ä½“éªŒæå‡**ï¼šæ¸…æ™°çš„ç§¯åˆ†æ˜¾ç¤ºå’Œæ¶ˆè€—æç¤ºï¼Œæ˜ç¡®çš„è®¢é˜…æƒç›Šå¯¹æ¯”
2. **æ›´é«˜çš„ç”¨æˆ·ç•™å­˜**ï¼šé€šè¿‡ç§¯åˆ†æ»šå­˜å’Œæ— é™å†™ä½œç‰¹æƒæé«˜ç”¨æˆ·ç²˜æ€§
3. **å¢åŠ ä»˜è´¹è½¬åŒ–**ï¼šé€šè¿‡ Pro è®¡åˆ’çš„"æ— é™å†™ä½œ"å–ç‚¹å’Œ Unlimited è®¡åˆ’çš„é«˜ç§¯åˆ†æ´¥è´´å¸å¼•ç”¨æˆ·å‡çº§
4. **æ›´å¥½çš„æˆæœ¬æ§åˆ¶**ï¼šåŒºåˆ†æ–‡æœ¬å’Œå›¾åƒæˆæœ¬ï¼Œé™åˆ¶é«˜æˆæœ¬èµ„æºæ»¥ç”¨
5. **æ›´æ¸…æ™°çš„å•†ä¸šæ¨¡å‹**ï¼š"æ–‡å­—åŒ…æœˆ + å›¾ç‰‡æŒ‰é‡"çš„å¥åº·æ¨¡å¼ï¼Œé€‚åˆ AI æ–‡å­—ç±»äº§å“

é€šè¿‡ä»¥ä¸Šå®ç°ï¼ŒScribely å°†å½¢æˆä¸€ä¸ªå¥åº·çš„å•†ä¸šæ¨¡å¼ï¼Œæ—¢æ»¡è¶³ç”¨æˆ·çš„å†™ä½œéœ€æ±‚ï¼Œåˆèƒ½æœ‰æ•ˆæ§åˆ¶æˆæœ¬ï¼Œå®ç°å¯æŒç»­å‘å±•ã€‚